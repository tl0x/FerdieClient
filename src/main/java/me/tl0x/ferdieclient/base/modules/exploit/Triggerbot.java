package me.tl0x.ferdieclient.base.modules.exploit;

import me.tl0x.ferdieclient.FerdieClient;
import me.tl0x.ferdieclient.base.bases.Module;
import me.tl0x.ferdieclient.base.modules.ModuleType;
import net.minecraft.client.MinecraftClient;
import net.minecraft.client.network.ClientPlayerInteractionManager;
import net.minecraft.entity.Entity;
import net.minecraft.entity.LivingEntity;
import net.minecraft.item.AxeItem;
import net.minecraft.item.SwordItem;
import net.minecraft.util.Hand;

public class Triggerbot extends Module {

    private Entity target = null;

    public Triggerbot() {
        super("Triggerbot", "Attacks when crosshair target is a player and holding a sword");
        this.setModuleType(ModuleType.MODULETYPE_EXPLOIT);
    }

    @Override
    public void onTick() {
        if (MinecraftClient.getInstance().player.getHealth() <= 0 || MinecraftClient.getInstance().player.getAttackCooldownProgress(0.5f) < 1)
            return;
        if (!(MinecraftClient.getInstance().targetedEntity instanceof LivingEntity)) return;
        if (((LivingEntity) MinecraftClient.getInstance().targetedEntity).getHealth() <= 0) return;

        if (MinecraftClient.getInstance().player.getMainHandStack().getItem() instanceof AxeItem || MinecraftClient.getInstance().player.getMainHandStack().getItem() instanceof SwordItem) {
            target = MinecraftClient.getInstance().targetedEntity;
            attackEntity(target);
        }

        super.onTick();
    }

    public void attackEntity(Entity e) {
        ClientPlayerInteractionManager im = FerdieClient.client.interactionManager;
        im.attackEntity(FerdieClient.client.player, e);
        FerdieClient.client.player.swingHand(Hand.MAIN_HAND);
    }
}
